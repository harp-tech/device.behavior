<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="clr-namespace:Harp.Behavior.Design.Controls"
             xmlns:conv="clr-namespace:Harp.Behavior.Design.Converters"
             xmlns:heroIcons="clr-namespace:HeroIconsAvalonia.Controls;assembly=HeroIconsAvalonia"
             xmlns:local="clr-namespace:Harp.Behavior;assembly=Harp.Behavior"
             xmlns:md="clr-namespace:Markdown.Avalonia;assembly=Markdown.Avalonia"
             xmlns:system="clr-namespace:System;assembly=System.Runtime"
             xmlns:vm="clr-namespace:Harp.Behavior.Design.ViewModels"
             mc:Ignorable="d" d:DesignWidth="4000" d:DesignHeight="1850"
             x:Class="Harp.Behavior.Design.Views.BehaviorView"
             x:DataType="vm:BehaviorViewModel">

  <UserControl.Resources>
    <conv:EnableFlagConverter x:Key="EnableFlagConverter"/>
    <conv:PayloadFieldConverter x:Key="PayloadFieldConverter"/>
    <conv:VisualStatusColorConverter x:Key="VisualStatusColorConverter"/>
    <conv:BooleanConverter x:Key="BooleanConverter" />
  </UserControl.Resources>

  <UserControl.Styles>

    <Style Selector="Expander:expanded /template/ Border#ExpanderContent">
      <Setter Property="Background" Value="Red"/>
      <Setter Property="BorderThickness" Value="0"/>


    </Style>

    <Style Selector="Expander:expanded /template/ Border#ExpanderContent">
      <Setter Property="BorderThickness" Value="0"/>
    </Style>

  </UserControl.Styles>

  <Design.DataContext>
    <!-- This only sets the DataContext for the previewer in an IDE,
         to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
    <vm:BehaviorViewModel />
  </Design.DataContext>

  <DockPanel>
    <Grid Margin="10" DockPanel.Dock="Top"
          ColumnDefinitions="Auto, Auto, *, Auto, Auto"
          RowDefinitions="30,25,*,*">
      <TextBlock Grid.Row="0"
                 Text="Behavior"
                 HorizontalAlignment="Left"
                 VerticalAlignment="Bottom"
                 FontWeight="Bold"
                 FontSize="17" />
      <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="2">
        <TextBlock Text="{Binding AppVersion}"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Bottom"
                   FontWeight="Bold"
                   FontSize="17"
                   Margin="5,0,0,0" />
        <Button Background="Transparent" Command="{Binding ShowAboutCommand}">
          <heroIcons:HeroIcon Foreground="{Binding IconColor}" Type="QuestionMarkCircle" Width="14"/>
        </Button>
      </StackPanel>
      <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Text="Hardware &amp; Software Platform" HorizontalAlignment="Left"
                     Foreground="{StaticResource BlueAccentColor}" MaxWidth="240" VerticalAlignment="Center" FontWeight="Bold" TextWrapping="WrapWithOverflow" FontSize="12" />
      <ThemeVariantScope Grid.Row="0" Grid.Column="2" Grid.RowSpan="2" Grid.ColumnSpan="2"
                               RequestedThemeVariant="Light">
        <Image VerticalAlignment="Center"
               HorizontalAlignment="Right"
               Margin="0,5,5,0"
               IsVisible="{Binding !IsDarkMode}"
               Source="/Assets/cf-logo.png" />
      </ThemeVariantScope>
      <ThemeVariantScope Grid.Row="0" Grid.Column="2" Grid.RowSpan="2" Grid.ColumnSpan="2"
                         RequestedThemeVariant="Dark">
        <Image VerticalAlignment="Center"
               HorizontalAlignment="Right"
               Margin="0,5,5,0"
               IsVisible="{Binding IsDarkMode}"
               Source="/Assets/cf-logo-white-lettering.png" />
      </ThemeVariantScope>
      <ToggleSwitch Grid.Row="0" Grid.Column="4" Grid.RowSpan="2" Margin="10,0,0,0" ToolTip.Tip="Change theme"
                          Content="Theme" FontWeight="Normal" FontSize="14"
                          IsChecked="{Binding IsDarkMode}">
        <ToggleSwitch.OnContent>
          <heroIcons:HeroIcon Foreground="{Binding IconColor}" Type="Moon" Width="16" Height="16" />
        </ToggleSwitch.OnContent>
        <ToggleSwitch.OffContent>
          <heroIcons:HeroIcon Foreground="{Binding IconColor}" Type="Sun" Width="16" Height="16" />
        </ToggleSwitch.OffContent>
      </ToggleSwitch>
    </Grid>

    <Grid DockPanel.Dock="Bottom" RowDefinitions="Auto" ColumnDefinitions="Auto,*,Auto,Auto" Margin="10">
      <Button Grid.Row="0" Grid.Column="3"
              Command="{Binding SaveConfigurationCommand}"
              Content="Save configuration"
              Margin="10,0,0,0"
              Background="{StaticResource BlueAccentColor}"
              Foreground="White">
        <Button.CommandParameter>
          <system:Boolean>false</system:Boolean>
        </Button.CommandParameter>
      </Button>
      <Button Grid.Row="0" Grid.Column="2" Command="{Binding SaveConfigurationCommand}"
              Content="Save configuration permanently">
        <Button.CommandParameter>
          <system:Boolean>true</system:Boolean>
        </Button.CommandParameter>
      </Button>
      <Button Grid.Row="0" Grid.Column="0" Command="{Binding ResetConfigurationCommand}"
              Content="Reset to defaults" />
    </Grid>

    <ScrollViewer HorizontalScrollBarVisibility="Auto" Padding="0">
      <StackPanel Spacing="12" Margin="0,20,0,0">
        <Panel Height="36">
          <TextBlock Text="Device connection" VerticalAlignment="Center" FontSize="20" FontWeight="SemiBold"
                     Margin="10,0" />
        </Panel>
        <Grid ColumnDefinitions="*,*,*,*,*" RowDefinitions="*,*" Margin="0,0,50,0" MinHeight="60">
          <StackPanel Grid.RowSpan="2" VerticalAlignment="Bottom" Margin="10" Orientation="Horizontal"
                      Spacing="20">
            <TextBlock Text="Select a device" VerticalAlignment="Center" />
            <ComboBox Name="Ports" ItemsSource="{Binding Ports}" SelectedItem="{Binding SelectedPort}"
                      MinWidth="70" />
            <Button Command="{Binding LoadDeviceInformation}">
              <heroIcons:HeroIcon Foreground="{Binding IconColor}" Type="ArrowPath" Width="16" Height="16" />
            </Button>
            <Button Content="{Binding ConnectButtonText}"
                    Command="{Binding ConnectAndGetBaseInfoCommand}" />
            <ToggleButton Grid.Row="0" Grid.Column="2"
                    Command="{Binding ShowMessagesCommand}">
              <heroIcons:HeroIcon Foreground="{Binding IconColor}" Type="DocumentText" Width="16" Height="16" />
            </ToggleButton>
          </StackPanel>
          <Grid Grid.Row="0" Grid.Column="1" ColumnDefinitions="25,25,30,*" RowDefinitions="*,*,*"
                Margin="20, 0, 0, 0" IsVisible="{Binding Connected}">
            <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" VerticalAlignment="Center"
                       HorizontalAlignment="Left" Text="{Binding DeviceName}" FontWeight="Bold"
                       FontSize="24" />
            <TextBlock Grid.Row="1" Grid.Column="0" Text="Hw " VerticalAlignment="Bottom" />
            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding HardwareVersion}" FontWeight="Bold"
                       VerticalAlignment="Bottom" />
            <TextBlock Grid.Row="2" Grid.Column="0" Text="Fw " VerticalAlignment="Top" />
            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding FirmwareVersion}" FontWeight="Bold"
                       VerticalAlignment="Top" />
            <TextBlock Grid.Row="1" Grid.Column="2" Grid.RowSpan="2" Text="S/N " VerticalAlignment="Center" />
            <TextBlock Grid.Row="1" Grid.Column="3" Grid.RowSpan="2" Text="{Binding SerialNumber}"
                       FontWeight="Bold" VerticalAlignment="Center" />
          </Grid>
        </Grid>
        <StackPanel>
          <TabControl Margin="0,0,0,0" TabStripPlacement="Top">

            <TabItem Header="Event Configuration" FontSize="20" FontWeight="SemiBold">
              <Grid Margin="10,10,0,10" ColumnDefinitions="Auto,Auto" RowDefinitions="Auto,*">

                <!-- Header -->
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Device Events" FontSize="18" FontWeight="Bold"
                           Margin="0,0,40,20" HorizontalAlignment="Left"/>

                <!-- Main Content Area -->
                <StackPanel Grid.Row="1" Grid.Column="0" Spacing="20" Margin="0,0,40,0" MinWidth="400">

                  <!-- Event Enable Configuration -->
                  <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                    <StackPanel Spacing="15">
                      <StackPanel Orientation="Horizontal" Spacing="5">
                        <TextBlock Text="Event Enable Register" FontWeight="Bold" FontSize="14"/>
                        <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                            Foreground="{Binding IconColor}" VerticalAlignment="Top">
                          <ToolTip.Tip>Specifies the active events in the device. Enable the events you want to monitor.</ToolTip.Tip>
                        </heroIcons:HeroIcon>
                      </StackPanel>

                      <!-- Port Events Section -->
                      <StackPanel Orientation="Vertical" Spacing="12">
                        <TextBlock Text="Port Events" FontWeight="SemiBold" FontSize="12"/>

                        <StackPanel Orientation="Vertical" Spacing="8" Margin="10,0,0,0">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <CheckBox IsChecked="{Binding IsPortDIEnabled}" IsEnabled="True">
                              Port DI
                            </CheckBox>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Center">
                              <ToolTip.Tip>Enable digital input port events</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>

                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <CheckBox IsChecked="{Binding IsPortDIOEnabled}" IsEnabled="True">
                              Port DIO
                            </CheckBox>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Center">
                              <ToolTip.Tip>Enable digital input/output port events</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                        </StackPanel>
                      </StackPanel>

                      <!-- Analog Events Section -->
                      <StackPanel Orientation="Vertical" Spacing="12">
                        <TextBlock Text="Analog Events" FontWeight="SemiBold" FontSize="12"/>

                        <StackPanel Orientation="Vertical" Spacing="8" Margin="10,0,0,0">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <CheckBox IsChecked="{Binding IsAnalogDataEnabled}" IsEnabled="True">
                              Analog Data
                            </CheckBox>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Center">
                              <ToolTip.Tip>Enable analog data acquisition events</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                        </StackPanel>
                      </StackPanel>

                      <!-- Camera Events Section -->
                      <StackPanel Orientation="Vertical" Spacing="12">
                        <TextBlock Text="Camera Events" FontWeight="SemiBold" FontSize="12"/>

                        <StackPanel Orientation="Vertical" Spacing="8" Margin="10,0,0,0">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <CheckBox IsChecked="{Binding IsCamera0Enabled}" IsEnabled="True">
                              Camera 0
                            </CheckBox>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Center">
                              <ToolTip.Tip>Enable Camera 0 frame acquisition events</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>

                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <CheckBox IsChecked="{Binding IsCamera1Enabled}" IsEnabled="True">
                              Camera 1
                            </CheckBox>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Center">
                              <ToolTip.Tip>Enable Camera 1 frame acquisition events</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                        </StackPanel>
                      </StackPanel>
                    </StackPanel>
                  </Border>

                </StackPanel>
              </Grid>
            </TabItem>

            <TabItem Header="Digital I/O" FontSize="20" FontWeight="SemiBold">
              <ScrollViewer>
                <Grid Margin="20">
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                  </Grid.RowDefinitions>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>

                  <!--Digital Outputs (DO0-DO3)-->
                  <StackPanel Grid.Row="0" Margin="0,0,0,15">
                    <TextBlock Text="Digital Outputs" FontSize="18" FontWeight="Bold"
                               Margin="0,0,0,5"/>

                    <Grid Margin="0,0,0,15">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                      </Grid.ColumnDefinitions>

                      <!-- Headers (reordered) -->
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Status" FontWeight="Bold"
                                  Margin="0,0,0,5" />
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold"
                                  Margin="0,0,0,5" />
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold"
                                  Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="PWM Control" FontWeight="Bold"
                                  Margin="0,0,0,5"/>
                      <Button Grid.Row="1" Grid.Column="5" Content="Apply" Command="{Binding DOApplyConfigurationCommand}" Margin="10,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="2" Grid.Column="5" Content="Apply" Command="{Binding DOApplyConfigurationCommand}" Margin="10,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="3" Grid.Column="5" Content="Apply" Command="{Binding DOApplyConfigurationCommand}" Margin="10,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>2</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="4" Grid.Column="5" Content="Apply" Command="{Binding DOApplyConfigurationCommand}" Margin="10,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>3</x:Int32>
                        </Button.CommandParameter>
                      </Button>


                      <!-- DO0 -->
                      <Border Grid.Row="1" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">DO 0</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital Output 0 control and status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDO0Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>

                      <!-- Output Control - Set and Clear side by side -->
                      <Border Grid.Row="1" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDO0Enabled_OutputSet}"
                                      Command="{Binding DO0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDO0Enabled_OutputClear}"
                                        Command="{Binding DO0ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>

                      <!-- Pulse Control - Duration and Enable side by side -->
                      <Border Grid.Row="1" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDO0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDO0Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>

                      <!-- PWM Control - All controls on one line -->
                      <Border Grid.Row="1" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,0,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Freq (Hz):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmFrequencyDO0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Duty (%):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmDutyCycleDO0}" Minimum="1" Maximum="99"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                            <ToggleButton IsChecked="{Binding IsPwmDO0Enabled_PwmStart}"
                                          Command="{Binding PwmDO0StartCommand}" MinWidth="45">
                              Start
                            </ToggleButton>
                            <ToggleButton IsChecked="{Binding IsPwmDO0Enabled_PwmStop}"
                                          Command="{Binding PwmDO0StopCommand}" MinWidth="45">
                              Stop
                            </ToggleButton>
                          </StackPanel>
                        </Grid>
                      </Border>

                      <!-- DO1 -->
                      <Border Grid.Row="2" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">DO 1</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital Output 1 control and status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDO1Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>

                      <!-- Output Control - Set and Clear side by side -->
                      <Border Grid.Row="2" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDO1Enabled_OutputSet}"
                                      Command="{Binding DO1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDO1Enabled_OutputClear}"
                                        Command="{Binding DO1ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="2" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDO1}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDO1Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>

                      <Border Grid.Row="2" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,0,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Freq (Hz):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmFrequencyDO1}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Duty (%):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmDutyCycleDO1}" Minimum="1" Maximum="99"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                            <ToggleButton IsChecked="{Binding IsPwmDO1Enabled_PwmStart}"
                                          Command="{Binding PwmDO1StartCommand}" MinWidth="45">
                              Start
                            </ToggleButton>
                            <ToggleButton IsChecked="{Binding IsPwmDO1Enabled_PwmStop}"
                                          Command="{Binding PwmDO1StopCommand}" MinWidth="45">
                              Stop
                            </ToggleButton>
                          </StackPanel>
                        </Grid>
                      </Border>

                      <!-- DO2 -->
                      <Border Grid.Row="3" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">DO 2</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital Output 2 control and status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDO2Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>

                      <!-- Output Control - Set and Clear side by side -->
                      <Border Grid.Row="3" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDO2Enabled_OutputSet}"
                                      Command="{Binding DO2SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDO2Enabled_OutputClear}"
                                        Command="{Binding DO2ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="3" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDO2}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDO2Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>

                      <Border Grid.Row="3" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,0,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Freq (Hz):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmFrequencyDO2}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Duty (%):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmDutyCycleDO2}" Minimum="1" Maximum="99"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                            <ToggleButton IsChecked="{Binding IsPwmDO2Enabled_PwmStart}"
                                          Command="{Binding PwmDO2StartCommand}" MinWidth="45">
                              Start
                            </ToggleButton>
                            <ToggleButton IsChecked="{Binding IsPwmDO2Enabled_PwmStop}"
                                          Command="{Binding PwmDO2StopCommand}" MinWidth="45">
                              Stop
                            </ToggleButton>
                          </StackPanel>
                        </Grid>
                      </Border>

                      <!-- DO3 -->
                      <Border Grid.Row="4" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">DO 3</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital Output 3 control and status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDO3Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>

                      <!-- Output Control - Set and Clear side by side -->
                      <Border Grid.Row="4" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDO3Enabled_OutputSet}"
                                      Command="{Binding DO3SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDO3Enabled_OutputClear}"
                                        Command="{Binding DO3ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="4" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDO3}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDO3Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>

                      <Border Grid.Row="4" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,0,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Freq (Hz):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmFrequencyDO3}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Duty (%):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmDutyCycleDO3}" Minimum="1" Maximum="99"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                            <ToggleButton IsChecked="{Binding IsPwmDO3Enabled_PwmStart}"
                                          Command="{Binding PwmDO3StartCommand}" MinWidth="45">
                              Start
                            </ToggleButton>
                            <ToggleButton IsChecked="{Binding IsPwmDO3Enabled_PwmStop}"
                                          Command="{Binding PwmDO3StopCommand}" MinWidth="45">
                              Stop
                            </ToggleButton>
                          </StackPanel>
                        </Grid>
                      </Border>

                    </Grid>
                  </StackPanel>

                  <!-- Port Outputs Section -->
                  <StackPanel Grid.Row="1" Margin="0,0,0,15">
                    <TextBlock Text="Port Outputs" FontSize="18" FontWeight="Bold" Margin="0,0,0,5"/>

                    <!-- PORT 0 -->
                    <Grid Margin="0,0,0,15">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                      </Grid.ColumnDefinitions>

                      <!-- Headers - Only once at the beginning -->
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Port 0 Status" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="Direction" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="4" Text="Mimic Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <Button Grid.Row="1" Grid.Column="5" Content="Apply" Command="{Binding Port0ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="2" Grid.Column="5" Content="Apply" Command="{Binding Port0ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="3" Grid.Column="5" Content="Apply" Command="{Binding Port0ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>2</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="4" Grid.Column="5" Content="Apply" Command="{Binding Port0ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>3</x:Int32>
                        </Button.CommandParameter>
                      </Button>

                      <!-- Port 0 Digital Output -->
                      <Border Grid.Row="1" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DO</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Port 0 digital output control</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDOPort0Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDOPort0Enabled_OutputSet}"
                                      Command="{Binding DOPort0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDOPort0Enabled_OutputClear}"
                                        Command="{Binding DOPort0ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDOPort0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDOPort0Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="1" Grid.Column="4" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2" HorizontalAlignment="Stretch">
                      </Border>
                      <!-- Port 0 Supply Output -->
                      <Border Grid.Row="2" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 12 V</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Port 0 supply output control</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsSupplyPort0Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="2" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsSupplyPort0Enabled_OutputSet}"
                                      Command="{Binding SupplyPort0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsSupplyPort0Enabled_OutputClear}"
                                        Command="{Binding SupplyPort0ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="2" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseSupplyPort0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsSupplyPort0Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>
                      <Border Grid.Row="2" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="2" Grid.Column="4" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" Spacing="5" >
                          <TextBlock Text="Valve:" VerticalAlignment="Center"/>
                          <ComboBox SelectedItem="{Binding MimicPort0Valve, Mode=TwoWay}" Width="120">
                            <x:Static Member="local:MimicOutput.None" />
                            <x:Static Member="local:MimicOutput.DIO0" />
                            <x:Static Member="local:MimicOutput.DIO1" />
                            <x:Static Member="local:MimicOutput.DIO2" />
                            <x:Static Member="local:MimicOutput.DO0" />
                            <x:Static Member="local:MimicOutput.DO1" />
                            <x:Static Member="local:MimicOutput.DO2" />
                            <x:Static Member="local:MimicOutput.DO3" />
                          </ComboBox>
                        </StackPanel>
                      </Border>

                      <!-- Port 0 DIO -->
                      <Border Grid.Row="3" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DIO</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>DIO 0 state event status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDIO0Enabled_PortDIOStateEvent}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="3" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDIO0Enabled_PortDIOSet}"
                                      Command="{Binding DIOPort0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDIO0Enabled_PortDIOClear}"
                                        Command="{Binding DIOPort0ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="3" Grid.Column="2" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="3" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <ComboBox SelectedItem="{Binding IsDIO0Enabled_PortDIODirection, Mode=TwoWay}"
                            IsEnabled="True"
                            Width="120"
                            HorizontalAlignment="Center">
                              <ComboBox.ItemTemplate>
                                <DataTemplate>
                                  <TextBlock Text="{Binding Converter={StaticResource BooleanConverter}}" />
                                </DataTemplate>
                              </ComboBox.ItemTemplate>
                              <system:Boolean>True</system:Boolean>
                              <system:Boolean>False</system:Boolean>
                            </ComboBox>
                          </StackPanel>
                        </Grid>
                      </Border>
                      <Border Grid.Row="3" Grid.Column="4" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>

                      <!-- Port 0 DI -->
                      <Border Grid.Row="4" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DI</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital input port 0 status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDIPort0Enabled_DigitalInputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="4" Grid.Column="1" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="2" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="4" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                          </Grid.ColumnDefinitions>

                          <TextBlock Grid.Column="0" Text="IR:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                          <ComboBox Grid.Column="1" SelectedItem="{Binding MimicPort0IR, Mode=TwoWay}" Width="120" HorizontalAlignment="Left">
                            <x:Static Member="local:MimicOutput.None" />
                            <x:Static Member="local:MimicOutput.DIO0" />
                            <x:Static Member="local:MimicOutput.DIO1" />
                            <x:Static Member="local:MimicOutput.DIO2" />
                            <x:Static Member="local:MimicOutput.DO0" />
                            <x:Static Member="local:MimicOutput.DO1" />
                            <x:Static Member="local:MimicOutput.DO2" />
                            <x:Static Member="local:MimicOutput.DO3" />
                          </ComboBox>
                        </Grid>
                      </Border>
                    </Grid>

                    <!-- PORT 1 -->
                    <Grid Margin="0,0,0,15">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                      </Grid.ColumnDefinitions>
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Port 1 Status" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="Direction" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="4" Text="Mimic Control" FontWeight="Bold" Margin="0,0,0,5"/>

                      <Button Grid.Row="1" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="2" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="3" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>2</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="4" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>3</x:Int32>
                        </Button.CommandParameter>
                      </Button>

                      <!-- Port 1 Digital Output -->
                      <Border Grid.Row="1" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 1 DO</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Port 1 digital output control</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDOPort1Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDOPort1Enabled_OutputSet}"
                                      Command="{Binding DOPort1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDOPort1Enabled_OutputClear}"
                                        Command="{Binding DOPort1ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDOPort1}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDOPort1Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="1" Grid.Column="4" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2" HorizontalAlignment="Stretch">
                      </Border>
                      <!-- Port 1 Supply Output -->
                      <Border Grid.Row="2" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 1 12 V</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Port 1 supply output control</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsSupplyPort1Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="2" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsSupplyPort1Enabled_OutputSet}"
                                      Command="{Binding SupplyPort1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsSupplyPort1Enabled_OutputClear}"
                                        Command="{Binding SupplyPort1ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="2" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseSupplyPort1}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsSupplyPort1Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>            
                      <Border Grid.Row="2" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="2" Grid.Column="4" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">

                        
                          <StackPanel Orientation="Horizontal" Spacing="5" >
                            <TextBlock Text="Valve:" VerticalAlignment="Center"/>
                            <ComboBox SelectedItem="{Binding MimicPort1Valve, Mode=TwoWay}" Width="120">
                              <x:Static Member="local:MimicOutput.None" />
                              <x:Static Member="local:MimicOutput.DIO0" />
                              <x:Static Member="local:MimicOutput.DIO1" />
                              <x:Static Member="local:MimicOutput.DIO2" />
                              <x:Static Member="local:MimicOutput.DO0" />
                              <x:Static Member="local:MimicOutput.DO1" />
                              <x:Static Member="local:MimicOutput.DO2" />
                              <x:Static Member="local:MimicOutput.DO3" />
                            </ComboBox>
                          </StackPanel>
                          
                        
                        
                          
                      
                      </Border>

                      <!-- Port 1 DIO -->
                      <Border Grid.Row="3" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 1 DIO</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>DIO 1 state event status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDIO0Enabled_PortDIOStateEvent}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="3" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDIO1Enabled_PortDIOSet}"
                                      Command="{Binding DIOPort1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDIO1Enabled_PortDIOClear}"
                                        Command="{Binding DIOPort1ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="3" Grid.Column="2" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="3" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <ComboBox SelectedItem="{Binding IsDIO1Enabled_PortDIODirection, Mode=TwoWay}"
                            IsEnabled="True"
                            Width="120"
                            HorizontalAlignment="Center">
                              <ComboBox.ItemTemplate>
                                <DataTemplate>
                                  <TextBlock Text="{Binding Converter={StaticResource BooleanConverter}}" />
                                </DataTemplate>
                              </ComboBox.ItemTemplate>
                              <system:Boolean>True</system:Boolean>
                              <system:Boolean>False</system:Boolean>
                            </ComboBox>
                          </StackPanel>
                        </Grid>
                        
                      </Border>
                      <Border Grid.Row="3" Grid.Column="4" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>

                      <!-- Port 1 DI -->
                      <Border Grid.Row="4" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 1 DI</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital input port 1 status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDIPort1Enabled_DigitalInputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>                   
                      <Border Grid.Row="4" Grid.Column="1" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="2" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="4" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                          </Grid.ColumnDefinitions>

                          <TextBlock Grid.Column="0" Text="IR:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                          <ComboBox Grid.Column="1" SelectedItem="{Binding MimicPort1IR, Mode=TwoWay}" Width="120" HorizontalAlignment="Left">
                            <x:Static Member="local:MimicOutput.None" />
                            <x:Static Member="local:MimicOutput.DIO0" />
                            <x:Static Member="local:MimicOutput.DIO1" />
                            <x:Static Member="local:MimicOutput.DIO2" />
                            <x:Static Member="local:MimicOutput.DO0" />
                            <x:Static Member="local:MimicOutput.DO1" />
                            <x:Static Member="local:MimicOutput.DO2" />
                            <x:Static Member="local:MimicOutput.DO3" />
                          </ComboBox>
                        </Grid>
                      </Border>
                    </Grid>

                    <!-- PORT 2 -->
                    <Grid Margin="0,0,0,15">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                      </Grid.ColumnDefinitions>
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Port 2 Status" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="Direction" FontWeight="Bold" Margin="0,0,0,5"/> 
                      <TextBlock Grid.Row="0" Grid.Column="4" Text="Mimic Control" FontWeight="Bold" Margin="0,0,0,5"/>

                      <Button Grid.Row="1" Grid.Column="5" Content="Apply" Command="{Binding Port2ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="2" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="3" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>2</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="4" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>3</x:Int32>
                        </Button.CommandParameter>
                      </Button>

                      <!-- Port 2 Digital Output -->
                      <Border Grid.Row="1" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 2 DO</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Port 2 digital output control</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDOPort2Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDOPort2Enabled_OutputSet}"
                                      Command="{Binding DOPort2SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDOPort2Enabled_OutputClear}"
                                        Command="{Binding DOPort2ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDOPort2}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDOPort2Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>
                      <Border Grid.Row="1" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="1" Grid.Column="4" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2" HorizontalAlignment="Stretch">
                      </Border>
                      <!-- Port 2 Supply Output -->
                      <Border Grid.Row="2" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 2 12 V</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Port 2 supply output control</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsSupplyPort2Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="2" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsSupplyPort2Enabled_OutputSet}"
                                      Command="{Binding SupplyPort2SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsSupplyPort2Enabled_OutputClear}"
                                        Command="{Binding SupplyPort2ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="2" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseSupplyPort2}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsSupplyPort2Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>
                      <Border Grid.Row="2" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="2" Grid.Column="4" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">


                        <StackPanel Orientation="Horizontal" Spacing="5" >
                          <TextBlock Text="Valve:" VerticalAlignment="Center"/>
                          <ComboBox SelectedItem="{Binding MimicPort2Valve, Mode=TwoWay}" Width="120">
                            <x:Static Member="local:MimicOutput.None" />
                            <x:Static Member="local:MimicOutput.DIO0" />
                            <x:Static Member="local:MimicOutput.DIO1" />
                            <x:Static Member="local:MimicOutput.DIO2" />
                            <x:Static Member="local:MimicOutput.DO0" />
                            <x:Static Member="local:MimicOutput.DO1" />
                            <x:Static Member="local:MimicOutput.DO2" />
                            <x:Static Member="local:MimicOutput.DO3" />
                          </ComboBox>
                        </StackPanel>

                      </Border>

                      <!-- Port 2 DIO -->
                      <Border Grid.Row="3" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 2 DIO</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>DIO 2 state event status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDIO2Enabled_PortDIOStateEvent}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="3" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsDIO2Enabled_PortDIOSet}"
                                      Command="{Binding DIOPort2SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDIO2Enabled_PortDIOClear}"
                                        Command="{Binding DIOPort2ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="3" Grid.Column="2" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="3" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <ComboBox SelectedItem="{Binding IsDIO2Enabled_PortDIODirection, Mode=TwoWay}"
                            IsEnabled="True"
                            Width="120"
                            HorizontalAlignment="Center">
                              <ComboBox.ItemTemplate>
                                <DataTemplate>
                                  <TextBlock Text="{Binding Converter={StaticResource BooleanConverter}}" />
                                </DataTemplate>
                              </ComboBox.ItemTemplate>
                              <system:Boolean>True</system:Boolean>
                              <system:Boolean>False</system:Boolean>
                            </ComboBox>
                          </StackPanel>
                        </Grid>

                      </Border>
                      <Border Grid.Row="3" Grid.Column="4" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>

                      <!-- Port 2 DI -->
                      <Border Grid.Row="4" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 2 DI</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital input port 2 status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDIPort2Enabled_DigitalInputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>
                      <Border Grid.Row="4" Grid.Column="1" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="2" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="3" BorderBrush="LightGray" Background="#F0F0F0" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                      </Border>
                      <Border Grid.Row="4" Grid.Column="4" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                          </Grid.ColumnDefinitions>

                          <TextBlock Grid.Column="0" Text="IR:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                          <ComboBox Grid.Column="1" SelectedItem="{Binding MimicPort2IR, Mode=TwoWay}" Width="120" HorizontalAlignment="Left">
                            <x:Static Member="local:MimicOutput.None" />
                            <x:Static Member="local:MimicOutput.DIO0" />
                            <x:Static Member="local:MimicOutput.DIO1" />
                            <x:Static Member="local:MimicOutput.DIO2" />
                            <x:Static Member="local:MimicOutput.DO0" />
                            <x:Static Member="local:MimicOutput.DO1" />
                            <x:Static Member="local:MimicOutput.DO2" />
                            <x:Static Member="local:MimicOutput.DO3" />
                          </ComboBox>
                        </Grid>
                      </Border>
                    </Grid>
                  </StackPanel>
                </Grid>
              </ScrollViewer>
            </TabItem>

            <TabItem Header="Remake" FontSize="20" FontWeight="SemiBold">
              <ScrollViewer>
                <Grid Margin="20">
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                  </Grid.RowDefinitions>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>

                  <!--Digital Outputs (DO0-DO3)-->
                  <StackPanel Grid.Row="0" Margin="0,0,0,15">
                    <TextBlock Text="Digital Outputs" FontSize="18" FontWeight="Bold"
                               Margin="0,0,0,5"/>

                    <Grid Margin="0,0,0,15">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                      </Grid.ColumnDefinitions>

                      <Rectangle Grid.Row="0" Height="1" Fill="LightGray" VerticalAlignment="Top" Grid.ColumnSpan="4"/>
                      <Rectangle Grid.Row="0" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="4"/>
                      <Rectangle Grid.Row="1" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="4"/>
                      <Rectangle Grid.Row="2" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="4"/>
                      <Rectangle Grid.Row="3" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="4"/>
                      <Rectangle Grid.Row="4" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="4"/>

                      <Rectangle Grid.Column="0" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="1" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="2" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="3" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="4" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>

                      <!-- Headers (reordered) -->
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Status" FontWeight="Bold"
                                  Margin="12,5,0,5" />
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold"
                                  Margin="12,5,0,5" />
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold"
                                  Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="PWM Control" FontWeight="Bold"
                                  Margin="12,5,0,5"/>

                      <!-- DO0 -->
                        <StackPanel Grid.Row="1" Grid.Column="0" Margin="20,12,20,12">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">DO 0</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital Output 0 control and status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDO0Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                    

                      <!-- Output Control - Set and Clear side by side -->
                        <StackPanel  Grid.Row="1" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                          <ToggleButton IsChecked="{Binding IsDO0Enabled_OutputSet}"
                                      Command="{Binding DO0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDO0Enabled_OutputClear}"
                                        Command="{Binding DO0ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>


                      <!-- Pulse Control - Duration and Enable side by side -->
                        <Grid Grid.Row="1" Grid.Column="2" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDO0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDO0Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      

                      <!-- PWM Control - All controls on one line -->
                    
                        <Grid Grid.Row="1" Grid.Column="3" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Freq (Hz):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmFrequencyDO0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Duty (%):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmDutyCycleDO0}" Minimum="1" Maximum="99"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                            <ToggleButton IsChecked="{Binding IsPwmDO0Enabled_PwmStart}"
                                          Command="{Binding PwmDO0StartCommand}" MinWidth="45">
                              Start
                            </ToggleButton>
                            <ToggleButton IsChecked="{Binding IsPwmDO0Enabled_PwmStop}"
                                          Command="{Binding PwmDO0StopCommand}" MinWidth="45">
                              Stop
                            </ToggleButton>
                          </StackPanel>
                        </Grid>
                

                      <!-- DO1 -->
            
                        <StackPanel Grid.Row="2" Grid.Column="0" Margin="20,12,20,12">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">DO 1</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital Output 1 control and status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDO1Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                  

                      <!-- Output Control - Set and Clear side by side -->
             
                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                          <ToggleButton IsChecked="{Binding IsDO1Enabled_OutputSet}"
                                      Command="{Binding DO1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDO1Enabled_OutputClear}"
                                        Command="{Binding DO1ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                 

                        <Grid Grid.Row="2" Grid.Column="2" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDO1}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDO1Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
 
         
                        <Grid Grid.Row="2" Grid.Column="3" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Freq (Hz):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmFrequencyDO1}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Duty (%):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmDutyCycleDO1}" Minimum="1" Maximum="99"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                            <ToggleButton IsChecked="{Binding IsPwmDO1Enabled_PwmStart}"
                                          Command="{Binding PwmDO1StartCommand}" MinWidth="45">
                              Start
                            </ToggleButton>
                            <ToggleButton IsChecked="{Binding IsPwmDO1Enabled_PwmStop}"
                                          Command="{Binding PwmDO1StopCommand}" MinWidth="45">
                              Stop
                            </ToggleButton>
                          </StackPanel>
                        </Grid>

                      <!-- DO2 -->
                      
                        <StackPanel Grid.Row="3" Grid.Column="0" Margin="20,12,20,12">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">DO 2</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital Output 2 control and status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDO2Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
               

                      <!-- Output Control - Set and Clear side by side -->
                    
                        <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                          <ToggleButton IsChecked="{Binding IsDO2Enabled_OutputSet}"
                                      Command="{Binding DO2SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDO2Enabled_OutputClear}"
                                        Command="{Binding DO2ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                   
                        <Grid Grid.Row="3" Grid.Column="2" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDO2}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDO2Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
     

                        <Grid Grid.Row="3" Grid.Column="3" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Freq (Hz):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmFrequencyDO2}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Duty (%):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmDutyCycleDO2}" Minimum="1" Maximum="99"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                            <ToggleButton IsChecked="{Binding IsPwmDO2Enabled_PwmStart}"
                                          Command="{Binding PwmDO2StartCommand}" MinWidth="45">
                              Start
                            </ToggleButton>
                            <ToggleButton IsChecked="{Binding IsPwmDO2Enabled_PwmStop}"
                                          Command="{Binding PwmDO2StopCommand}" MinWidth="45">
                              Stop
                            </ToggleButton>
                          </StackPanel>
                        </Grid>
      

                      <!-- DO3 -->
             
                        <StackPanel Grid.Row="4" Grid.Column="0" Margin="20,12,20,12">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">DO 3</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital Output 3 control and status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDO3Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      
                      <!-- Output Control - Set and Clear side by side -->
                        <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                          <ToggleButton IsChecked="{Binding IsDO3Enabled_OutputSet}"
                                      Command="{Binding DO3SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDO3Enabled_OutputClear}"
                                        Command="{Binding DO3ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>

             
                        <Grid  Grid.Row="4" Grid.Column="2" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDO3}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDO3Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
               
                        <Grid Grid.Row="4" Grid.Column="3" Margin="20,12,10,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Freq (Hz):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmFrequencyDO3}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Duty (%):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding PwmDutyCycleDO3}" Minimum="1" Maximum="99"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                            <ToggleButton IsChecked="{Binding IsPwmDO3Enabled_PwmStart}"
                                          Command="{Binding PwmDO3StartCommand}" MinWidth="45">
                              Start
                            </ToggleButton>
                            <ToggleButton IsChecked="{Binding IsPwmDO3Enabled_PwmStop}"
                                          Command="{Binding PwmDO3StopCommand}" MinWidth="45">
                              Stop
                            </ToggleButton>
                          </StackPanel>
                        </Grid>
               

                    </Grid>
                  </StackPanel>

                  <!-- Port Outputs Section -->
                  <StackPanel Grid.Row="1" Margin="0,0,0,15">
                    <TextBlock Text="Port Outputs" FontSize="18" FontWeight="Bold" Margin="0,0,0,5"/>

                    <!-- PORT 0 -->
                    <Grid Margin="0,0,0,30">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                      </Grid.ColumnDefinitions>

                      <Rectangle Grid.Row="0" Height="1" Fill="LightGray" VerticalAlignment="Top" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="0" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="1" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="2" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="3" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="4" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>

                      <Rectangle Grid.Column="0" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="1" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="2" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="3" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="4" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="5" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>

                      <!-- Headers - Only once at the beginning -->
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Port 0 Status" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="Direction" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="4" Text="Mimic Control" FontWeight="Bold" Margin="12,5,0,5"/>
                      
                      <Button Grid.Row="1" Grid.Column="5" Content="Apply" Command="{Binding Port0ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="2" Grid.Column="5" Content="Apply" Command="{Binding Port0ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="3" Grid.Column="5" Content="Apply" Command="{Binding Port0ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>2</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="4" Grid.Column="5" Content="Apply" Command="{Binding Port0ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>3</x:Int32>
                        </Button.CommandParameter>
                      </Button>

                      <!-- Port 0 Digital Output -->
                     
                        <StackPanel Grid.Row="1" Grid.Column="0" Margin="20,12,20,12">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DO</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Port 0 digital output control</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDOPort0Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10"  Grid.Row="1" Grid.Column="1" Margin="20,12,20,12">
                          <ToggleButton IsChecked="{Binding IsDOPort0Enabled_OutputSet}"
                                      Command="{Binding DOPort0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDOPort0Enabled_OutputClear}"
                                        Command="{Binding DOPort0ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
           
                        <Grid Grid.Row="1" Grid.Column="2" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseDOPort0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsDOPort0Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                  
               
                      <!-- Port 0 Supply Output -->
                      
                        <StackPanel Grid.Row="2" Grid.Column="0" Margin="20,12,20,12">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 12 V</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Port 0 supply output control</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsSupplyPort0Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                  
                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                          <ToggleButton IsChecked="{Binding IsSupplyPort0Enabled_OutputSet}"
                                      Command="{Binding SupplyPort0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsSupplyPort0Enabled_OutputClear}"
                                        Command="{Binding SupplyPort0ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                  
                        <Grid Grid.Row="2" Grid.Column="2" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseSupplyPort0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsSupplyPort0Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
      
                        <StackPanel Grid.Row="2" Grid.Column="4" Orientation="Horizontal" Spacing="5" Margin="20,12,20,12" >
                          <TextBlock Text="Valve:" VerticalAlignment="Center"/>
                          <ComboBox SelectedItem="{Binding MimicPort0Valve, Mode=TwoWay}" Width="120">
                            <x:Static Member="local:MimicOutput.None" />
                            <x:Static Member="local:MimicOutput.DIO0" />
                            <x:Static Member="local:MimicOutput.DIO1" />
                            <x:Static Member="local:MimicOutput.DIO2" />
                            <x:Static Member="local:MimicOutput.DO0" />
                            <x:Static Member="local:MimicOutput.DO1" />
                            <x:Static Member="local:MimicOutput.DO2" />
                            <x:Static Member="local:MimicOutput.DO3" />
                          </ComboBox>
                        </StackPanel>
                  

                      <!-- Port 0 DIO -->
                  
                        <StackPanel Grid.Row="3" Grid.Column="0"  Margin="20,12,20,12">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DIO</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>DIO 0 state event status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDIO0Enabled_PortDIOStateEvent}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
               

                        <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                          <ToggleButton IsChecked="{Binding IsDIO0Enabled_PortDIOSet}"
                                      Command="{Binding DIOPort0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsDIO0Enabled_PortDIOClear}"
                                        Command="{Binding DIOPort0ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                  
                   

                        <Grid Grid.Row="3" Grid.Column="3" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <ComboBox SelectedItem="{Binding IsDIO0Enabled_PortDIODirection, Mode=TwoWay}"
                            IsEnabled="True"
                            Width="120"
                            HorizontalAlignment="Center">
                              <ComboBox.ItemTemplate>
                                <DataTemplate>
                                  <TextBlock Text="{Binding Converter={StaticResource BooleanConverter}}" />
                                </DataTemplate>
                              </ComboBox.ItemTemplate>
                              <system:Boolean>True</system:Boolean>
                              <system:Boolean>False</system:Boolean>
                            </ComboBox>
                          </StackPanel>
                        </Grid>
                  

                      <!-- Port 0 DI -->
   
                        <StackPanel Grid.Row="4" Grid.Column="0" Margin="20,12,20,12">
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DI</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>Digital input port 0 status</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsDIPort0Enabled_DigitalInputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
  

                        <Grid Grid.Row="4" Grid.Column="4" Margin="20,12,20,12">
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                          </Grid.ColumnDefinitions>
                          <TextBlock Grid.Column="0" Text="IR:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                          <ComboBox Grid.Column="1" SelectedItem="{Binding MimicPort0IR, Mode=TwoWay}" Width="120" HorizontalAlignment="Left">
                            <x:Static Member="local:MimicOutput.None" />
                            <x:Static Member="local:MimicOutput.DIO0" />
                            <x:Static Member="local:MimicOutput.DIO1" />
                            <x:Static Member="local:MimicOutput.DIO2" />
                            <x:Static Member="local:MimicOutput.DO0" />
                            <x:Static Member="local:MimicOutput.DO1" />
                            <x:Static Member="local:MimicOutput.DO2" />
                            <x:Static Member="local:MimicOutput.DO3" />
                          </ComboBox>
                        </Grid>
                    </Grid>

                    <!-- PORT 1 -->
                    <Grid Margin="0,0,0,30">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                      </Grid.ColumnDefinitions>
                      <Rectangle Grid.Row="0" Height="1" Fill="LightGray" VerticalAlignment="Top" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="0" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="1" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="2" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="3" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="4" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>

                      <Rectangle Grid.Column="0" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="1" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="2" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="3" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="4" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="5" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>

                      <!-- Headers - Only once at the beginning -->
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Port 1 Status" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="Direction" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="4" Text="Mimic Control" FontWeight="Bold" Margin="12,5,0,5"/>

                      <Button Grid.Row="1" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="2" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="3" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>2</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="4" Grid.Column="5" Content="Apply" Command="{Binding Port1ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>3</x:Int32>
                        </Button.CommandParameter>
                      </Button>

                      <!-- Port 0 Digital Output -->

                      <StackPanel Grid.Row="1" Grid.Column="0" Margin="20,12,20,12">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DO</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Port 1 digital output control</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                          <controls:VisualStatus Status="{Binding IsDOPort1Enabled_OutputState}" Width="15" Height="15"/>
                          <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>

                      <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10"  Grid.Row="1" Grid.Column="1" Margin="20,12,20,12">
                        <ToggleButton IsChecked="{Binding IsDOPort1Enabled_OutputSet}"
                                    Command="{Binding DOPort1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                          Set
                        </ToggleButton>
                        <ToggleButton IsChecked="{Binding IsDOPort1Enabled_OutputClear}"
                                      Command="{Binding DOPort1ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                          Clear
                        </ToggleButton>
                      </StackPanel>

                      <Grid Grid.Row="1" Grid.Column="2" Margin="20,12,20,12">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="Auto"/>
                          <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                          <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                          <NumericUpDown Value="{Binding PulseDOPort1}" Minimum="1" Maximum="65535"
                                         Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                        </StackPanel>
                        <CheckBox Grid.Column="1" IsChecked="{Binding IsDOPort1Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                          Enable
                        </CheckBox>
                      </Grid>


                      <!-- Port 0 Supply Output -->

                      <StackPanel Grid.Row="2" Grid.Column="0" Margin="20,12,20,12">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 12 V</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Port 1 supply output control</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                          <controls:VisualStatus Status="{Binding IsSupplyPort1Enabled_OutputState}" Width="15" Height="15"/>
                          <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>

                      <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                        <ToggleButton IsChecked="{Binding IsSupplyPort1Enabled_OutputSet}"
                                    Command="{Binding SupplyPort1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                          Set
                        </ToggleButton>
                        <ToggleButton IsChecked="{Binding IsSupplyPort1Enabled_OutputClear}"
                                      Command="{Binding SupplyPort1ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                          Clear
                        </ToggleButton>
                      </StackPanel>

                      <Grid Grid.Row="2" Grid.Column="2" Margin="20,12,20,12">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="Auto"/>
                          <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                          <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                          <NumericUpDown Value="{Binding PulseSupplyPort1}" Minimum="1" Maximum="65535"
                                         Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                        </StackPanel>
                        <CheckBox Grid.Column="1" IsChecked="{Binding IsSupplyPort1Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                          Enable
                        </CheckBox>
                      </Grid>

                      <StackPanel Grid.Row="2" Grid.Column="4" Orientation="Horizontal" Spacing="5" Margin="20,12,20,12" >
                        <TextBlock Text="Valve:" VerticalAlignment="Center"/>
                        <ComboBox SelectedItem="{Binding MimicPort1Valve, Mode=TwoWay}" Width="120">
                          <x:Static Member="local:MimicOutput.None" />
                          <x:Static Member="local:MimicOutput.DIO0" />
                          <x:Static Member="local:MimicOutput.DIO1" />
                          <x:Static Member="local:MimicOutput.DIO2" />
                          <x:Static Member="local:MimicOutput.DO0" />
                          <x:Static Member="local:MimicOutput.DO1" />
                          <x:Static Member="local:MimicOutput.DO2" />
                          <x:Static Member="local:MimicOutput.DO3" />
                        </ComboBox>
                      </StackPanel>


                      <!-- Port 0 DIO -->

                      <StackPanel Grid.Row="3" Grid.Column="0"  Margin="20,12,20,12">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DIO</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>DIO 1 state event status</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                          <controls:VisualStatus Status="{Binding IsDIO1Enabled_PortDIOStateEvent}" Width="15" Height="15"/>
                          <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>


                      <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                        <ToggleButton IsChecked="{Binding IsDIO1Enabled_PortDIOSet}"
                                    Command="{Binding DIOPort1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                          Set
                        </ToggleButton>
                        <ToggleButton IsChecked="{Binding IsDIO1Enabled_PortDIOClear}"
                                      Command="{Binding DIOPort1ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                          Clear
                        </ToggleButton>
                      </StackPanel>



                      <Grid Grid.Row="3" Grid.Column="3" Margin="20,12,20,12">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="Auto"/>
                          <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                          <ComboBox SelectedItem="{Binding IsDIO1Enabled_PortDIODirection, Mode=TwoWay}"
                          IsEnabled="True"
                          Width="120"
                          HorizontalAlignment="Center">
                            <ComboBox.ItemTemplate>
                              <DataTemplate>
                                <TextBlock Text="{Binding Converter={StaticResource BooleanConverter}}" />
                              </DataTemplate>
                            </ComboBox.ItemTemplate>
                            <system:Boolean>True</system:Boolean>
                            <system:Boolean>False</system:Boolean>
                          </ComboBox>
                        </StackPanel>
                      </Grid>


                      <!-- Port 0 DI -->

                      <StackPanel Grid.Row="4" Grid.Column="0" Margin="20,12,20,12">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DI</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Digital input port 1 status</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                          <controls:VisualStatus Status="{Binding IsDIPort1Enabled_DigitalInputState}" Width="15" Height="15"/>
                          <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>


                      <Grid Grid.Row="4" Grid.Column="4" Margin="20,12,20,12">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="45"/>
                          <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="IR:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <ComboBox Grid.Column="1" SelectedItem="{Binding MimicPort1IR, Mode=TwoWay}" Width="120" HorizontalAlignment="Left">
                          <x:Static Member="local:MimicOutput.None" />
                          <x:Static Member="local:MimicOutput.DIO0" />
                          <x:Static Member="local:MimicOutput.DIO1" />
                          <x:Static Member="local:MimicOutput.DIO2" />
                          <x:Static Member="local:MimicOutput.DO0" />
                          <x:Static Member="local:MimicOutput.DO1" />
                          <x:Static Member="local:MimicOutput.DO2" />
                          <x:Static Member="local:MimicOutput.DO3" />
                        </ComboBox>
                      </Grid>
                    </Grid>

                    <!-- PORT 2 -->
                    <Grid Margin="0,0,0,30">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                      </Grid.ColumnDefinitions>
                      <Rectangle Grid.Row="0" Height="1" Fill="LightGray" VerticalAlignment="Top" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="0" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="1" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="2" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="3" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>
                      <Rectangle Grid.Row="4" Height="1" Fill="LightGray" VerticalAlignment="Bottom" Grid.ColumnSpan="5"/>

                      <Rectangle Grid.Column="0" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="1" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="2" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="3" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="4" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>
                      <Rectangle Grid.Column="5" Width="1" Fill="LightGray" HorizontalAlignment="Left" VerticalAlignment="Stretch" Grid.RowSpan="5"/>

                      <!-- Headers - Only once at the beginning -->
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Port 2 Status" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="Direction" FontWeight="Bold" Margin="12,5,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="4" Text="Mimic Control" FontWeight="Bold" Margin="12,5,0,5"/>
                      <Button Grid.Row="1" Grid.Column="5" Content="Apply" Command="{Binding Port2ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="2" Grid.Column="5" Content="Apply" Command="{Binding Port2ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="3" Grid.Column="5" Content="Apply" Command="{Binding Port2ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>2</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                      <Button Grid.Row="4" Grid.Column="5" Content="Apply" Command="{Binding Port2ApplyConfigurationCommand}" Margin="0,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>3</x:Int32>
                        </Button.CommandParameter>
                      </Button>

                      <!-- Port 0 Digital Output -->

                      <StackPanel Grid.Row="1" Grid.Column="0" Margin="20,12,20,12">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 2 DO</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Port 2 digital output control</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                          <controls:VisualStatus Status="{Binding IsDOPort2Enabled_OutputState}" Width="15" Height="15"/>
                          <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>

                      <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10"  Grid.Row="1" Grid.Column="1" Margin="20,12,20,12">
                        <ToggleButton IsChecked="{Binding IsDOPort2Enabled_OutputSet}"
                                    Command="{Binding DOPort2SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                          Set
                        </ToggleButton>
                        <ToggleButton IsChecked="{Binding IsDOPort2Enabled_OutputClear}"
                                      Command="{Binding DOPort2ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                          Clear
                        </ToggleButton>
                      </StackPanel>

                      <Grid Grid.Row="1" Grid.Column="2" Margin="20,12,20,12">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="Auto"/>
                          <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                          <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                          <NumericUpDown Value="{Binding PulseDOPort2}" Minimum="1" Maximum="65535"
                                         Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                        </StackPanel>
                        <CheckBox Grid.Column="1" IsChecked="{Binding IsDOPort2Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                          Enable
                        </CheckBox>
                      </Grid>


                      <!-- Port 0 Supply Output -->

                      <StackPanel Grid.Row="2" Grid.Column="0" Margin="20,12,20,12">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 12 V</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Port 2 supply output control</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                          <controls:VisualStatus Status="{Binding IsSupplyPort2Enabled_OutputState}" Width="15" Height="15"/>
                          <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>

                      <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                        <ToggleButton IsChecked="{Binding IsSupplyPort2Enabled_OutputSet}"
                                    Command="{Binding SupplyPort2SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                          Set
                        </ToggleButton>
                        <ToggleButton IsChecked="{Binding IsSupplyPort2Enabled_OutputClear}"
                                      Command="{Binding SupplyPort2ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                          Clear
                        </ToggleButton>
                      </StackPanel>

                      <Grid Grid.Row="2" Grid.Column="2" Margin="20,12,20,12">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="Auto"/>
                          <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                          <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                          <NumericUpDown Value="{Binding PulseSupplyPort0}" Minimum="1" Maximum="65535"
                                         Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                        </StackPanel>
                        <CheckBox Grid.Column="1" IsChecked="{Binding IsSupplyPort2Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                          Enable
                        </CheckBox>
                      </Grid>

                      <StackPanel Grid.Row="2" Grid.Column="4" Orientation="Horizontal" Spacing="5" Margin="20,12,20,12" >
                        <TextBlock Text="Valve:" VerticalAlignment="Center"/>
                        <ComboBox SelectedItem="{Binding MimicPort2Valve, Mode=TwoWay}" Width="120">
                          <x:Static Member="local:MimicOutput.None" />
                          <x:Static Member="local:MimicOutput.DIO0" />
                          <x:Static Member="local:MimicOutput.DIO1" />
                          <x:Static Member="local:MimicOutput.DIO2" />
                          <x:Static Member="local:MimicOutput.DO0" />
                          <x:Static Member="local:MimicOutput.DO1" />
                          <x:Static Member="local:MimicOutput.DO2" />
                          <x:Static Member="local:MimicOutput.DO3" />
                        </ComboBox>
                      </StackPanel>


                      <!-- Port 0 DIO -->

                      <StackPanel Grid.Row="3" Grid.Column="0"  Margin="20,12,20,12">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DIO</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>DIO 0 state event status</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                          <controls:VisualStatus Status="{Binding IsDIO2Enabled_PortDIOStateEvent}" Width="15" Height="15"/>
                          <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>


                      <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10" Margin="20,12,20,12">
                        <ToggleButton IsChecked="{Binding IsDIO2Enabled_PortDIOSet}"
                                    Command="{Binding DIOPort2SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                          Set
                        </ToggleButton>
                        <ToggleButton IsChecked="{Binding IsDIO2Enabled_PortDIOClear}"
                                      Command="{Binding DIOPort2ClearCommand}" Width="55" HorizontalContentAlignment="Center">
                          Clear
                        </ToggleButton>
                      </StackPanel>



                      <Grid Grid.Row="3" Grid.Column="3" Margin="20,12,20,12">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="Auto"/>
                          <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                          <ComboBox SelectedItem="{Binding IsDIO2Enabled_PortDIODirection, Mode=TwoWay}"
                          IsEnabled="True"
                          Width="120"
                          HorizontalAlignment="Center">
                            <ComboBox.ItemTemplate>
                              <DataTemplate>
                                <TextBlock Text="{Binding Converter={StaticResource BooleanConverter}}" />
                              </DataTemplate>
                            </ComboBox.ItemTemplate>
                            <system:Boolean>True</system:Boolean>
                            <system:Boolean>False</system:Boolean>
                          </ComboBox>
                        </StackPanel>
                      </Grid>


                      <!-- Port 0 DI -->

                      <StackPanel Grid.Row="4" Grid.Column="0" Margin="20,12,20,12">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="Bold" FontSize="14" Padding="0">PORT 0 DI</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Digital input port 2 status</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                          <controls:VisualStatus Status="{Binding IsDIPort2Enabled_DigitalInputState}" Width="15" Height="15"/>
                          <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>


                      <Grid Grid.Row="4" Grid.Column="4" Margin="20,12,20,12">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="45"/>
                          <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="IR:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <ComboBox Grid.Column="1" SelectedItem="{Binding MimicPort2IR, Mode=TwoWay}" Width="120" HorizontalAlignment="Left">
                          <x:Static Member="local:MimicOutput.None" />
                          <x:Static Member="local:MimicOutput.DIO0" />
                          <x:Static Member="local:MimicOutput.DIO1" />
                          <x:Static Member="local:MimicOutput.DIO2" />
                          <x:Static Member="local:MimicOutput.DO0" />
                          <x:Static Member="local:MimicOutput.DO1" />
                          <x:Static Member="local:MimicOutput.DO2" />
                          <x:Static Member="local:MimicOutput.DO3" />
                        </ComboBox>
                      </Grid>
                    </Grid>
                  </StackPanel>
                </Grid>
              </ScrollViewer>
            </TabItem>

            <TabItem Header="RGBs and LEDs" FontSize="20" FontWeight="SemiBold">
              <ScrollViewer>
                <Grid Margin="20">
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                  </Grid.RowDefinitions>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>

                  <!-- LEDs Section -->
                  <StackPanel Grid.Row="2" Margin="0,0,0,15">
                    <TextBlock Text="LED Controls" FontSize="18" FontWeight="Bold" Margin="0,0,0,5"/>


                    <Grid Margin="0,0,0,15">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                      </Grid.ColumnDefinitions>

                      <!-- Headers -->
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Status" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="Current Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <Button Grid.Row="1" Grid.Column="4" Content="Apply"
                          Command="{Binding LedApplyConfigurationCommand}" Margin="10,0,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>

                      </Button>
                      <Button Grid.Row="2" Grid.Column="4" Content="Apply"
                            Command="{Binding LedApplyConfigurationCommand}" Margin="10,0,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>

                      <!-- LED 0 -->
                      <Border Grid.Row="1" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">LED 0</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>LED 0 current and pulse configuration</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsLed0Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="1" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsLed0Enabled_OutputSet}"
                                      Command="{Binding Led0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsLed0Enabled_OutputClear}"
                                        Command="{Binding Led0ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="1" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseLed0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsLed0Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>

                      <Border Grid.Row="1" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,0,2">
                        <Grid>
                          <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                          </Grid.RowDefinitions>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Current (mA):" VerticalAlignment="Center" MinWidth="70"/>
                            <NumericUpDown Value="{Binding Led0Current}" Minimum="2" Maximum="100"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="5">
                            <TextBlock Text="Max (mA):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding Led0MaxCurrent}" Minimum="2" Maximum="100"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                        </Grid>
                      </Border>

                      <!-- LED 1 -->
                      <Border Grid.Row="2" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">LED 1</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>LED 1 current and pulse configuration</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsLed1Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="2" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsLed1Enabled_OutputSet}"
                                      Command="{Binding Led1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsLed1Enabled_OutputClear}"
                                        Command="{Binding Led1ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="2" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseLed1}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsLed1Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>

                      <Border Grid.Row="2" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,0,2">
                        <Grid>
                          <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                          </Grid.RowDefinitions>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                            <TextBlock Text="Current (mA):" VerticalAlignment="Center" MinWidth="70"/>
                            <NumericUpDown Value="{Binding Led1Current}" Minimum="5" Maximum="100"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="5">
                            <TextBlock Text="Max (mA):" VerticalAlignment="Center" MinWidth="60"/>
                            <NumericUpDown Value="{Binding Led1MaxCurrent}" Minimum="5" Maximum="100"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                        </Grid>
                      </Border>
                    </Grid>
                  </StackPanel>

                  <!-- RGB Section -->
                  <StackPanel Grid.Row="3" Margin="0,0,0,0">
                    <TextBlock Text="RGB Controls" FontSize="18" FontWeight="Bold" Margin="0,0,0,5"/>

                    <Grid Margin="0,0,0,15">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                      </Grid.RowDefinitions>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                      </Grid.ColumnDefinitions>

                      <!-- Headers -->
                      <TextBlock Grid.Row="0" Grid.Column="0" Text="Status" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="1" Text="Output Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="2" Text="Pulse Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <TextBlock Grid.Row="0" Grid.Column="3" Text="Color Control" FontWeight="Bold" Margin="0,0,0,5"/>
                      <Button  Grid.Row="1" Grid.Column="4"
                          Content="Apply"
                          Command="{Binding Rgb0ApplyConfigurationCommand}"
                          Margin="10,0,0,0"
                          HorizontalAlignment="Left"
                          VerticalAlignment="Center"/>
                      <Button  Grid.Row="2" Grid.Column="4"
                          Content="Apply"
                          Command="{Binding Rgb1ApplyConfigurationCommand}"
                          Margin="10,0,0,0"
                          HorizontalAlignment="Left"
                          VerticalAlignment="Center"/>

                      <!-- RGB 0 -->
                      <Border Grid.Row="1" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">RGB 0</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>RGB 0 color and pulse configuration</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsRgb0Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="1" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsRgb0Enabled_OutputSet}"
                                      Command="{Binding Rgb0SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsRgb0Enabled_OutputClear}"
                                        Command="{Binding Rgb0ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="1" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseRgb0}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsRgb0Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>

                      <Border Grid.Row="1" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,0,2">
                        <controls:RgbRegisterControl DataContext="{Binding Rgb0Adapter}" HorizontalAlignment="Center"/>
                      </Border>

                      <!-- RGB 1 -->
                      <Border Grid.Row="2" Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5">
                            <Label FontWeight="Bold" FontSize="14" Padding="0">RGB 1</Label>
                            <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                                Foreground="{Binding IconColor}" VerticalAlignment="Top">
                              <ToolTip.Tip>RGB 1 color and pulse configuration</ToolTip.Tip>
                            </heroIcons:HeroIcon>
                          </StackPanel>
                          <StackPanel Orientation="Horizontal" Spacing="5" Margin="0,3,0,0">
                            <controls:VisualStatus Status="{Binding IsRgb1Enabled_OutputState}" Width="15" Height="15"/>
                            <TextBlock Text="Active" FontSize="12" VerticalAlignment="Center"/>
                          </StackPanel>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="2" Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                          <ToggleButton IsChecked="{Binding IsRgb1Enabled_OutputSet}"
                                      Command="{Binding Rgb1SetCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Set
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsRgb1Enabled_OutputClear}"
                                        Command="{Binding Rgb1ClearCommand}" Width="55"  HorizontalContentAlignment="Center">
                            Clear
                          </ToggleButton>
                        </StackPanel>
                      </Border>

                      <Border Grid.Row="2" Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,10,2">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="0,0,15,0">
                            <TextBlock Text="Duration (ms):" VerticalAlignment="Center" MinWidth="80"/>
                            <NumericUpDown Value="{Binding PulseRgb1}" Minimum="1" Maximum="65535"
                                           Width="150" ClipValueToMinMax="True" Increment="1" FormatString="F0"/>
                          </StackPanel>
                          <CheckBox Grid.Column="1" IsChecked="{Binding IsRgb1Enabled_OutputPulseEnable}" VerticalAlignment="Center">
                            Enable
                          </CheckBox>
                        </Grid>
                      </Border>

                      <Border Grid.Row="2" Grid.Column="3" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,2,0,2">
                        <controls:RgbRegisterControl DataContext="{Binding Rgb1Adapter}" HorizontalAlignment="Center"/>
                      </Border>
                    </Grid>

                  </StackPanel>

                </Grid>
              </ScrollViewer>
            </TabItem>

            <TabItem Header="Advanced Controls" FontSize="20" FontWeight="SemiBold">
              <Grid Margin="10,10,0,10" ColumnDefinitions="Auto,Auto,Auto, Auto, Auto" RowDefinitions="Auto,*">

                <!-- Headers -->
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Analog Inputs" FontSize="18" FontWeight="Bold"
                           Margin="0,0,40,20" HorizontalAlignment="Left"/>
                <TextBlock Grid.Row="0" Grid.Column="1" Text="Cameras" FontSize="18" FontWeight="Bold"
                           Margin="0,0,40,20" HorizontalAlignment="Left"/>
                <TextBlock Grid.Row="0" Grid.Column="2" Text="Servo Motors" FontSize="18" FontWeight="Bold"
                           Margin="0,0,40,20" HorizontalAlignment="Left"/>
                <TextBlock Grid.Row="0" Grid.Column="3" Text="Quadrature Encoder" FontSize="18" FontWeight="Bold"
                           Margin="0,0,40,20" HorizontalAlignment="Left"/>
                <TextBlock Grid.Row="0" Grid.Column="4" Text="Serial Timestamp" FontSize="18" FontWeight="Bold"
                           Margin="0,0,40,20" HorizontalAlignment="Left"/>

                <!-- Analog Inputs Section -->
                <StackPanel Grid.Row="1" Grid.Column="0" Spacing="20" Margin="0,0,40,0" MinWidth="280">

                  <!-- Analog Input Readings -->
                  <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                    <StackPanel Spacing="15">
                      <TextBlock Text="Analog Input Readings" FontWeight="Bold" FontSize="14"/>

                      <!-- AnalogInput0 -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Analog Input 0</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Voltage reading from analog input 0</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="3" Padding="10" Margin="10,0,0,0">
                          <Grid ColumnDefinitions="Auto,*">
                            <TextBlock Grid.Column="0" Text="Voltage:" VerticalAlignment="Center"
                                       FontWeight="SemiBold" Margin="0,0,15,0"/>
                            <TextBlock Grid.Column="1"
                                       Text="{Binding AnalogData,
                         Converter={StaticResource PayloadFieldConverter},
                         ConverterParameter='AnalogInput0'}"
                                       VerticalAlignment="Center" FontSize="14" FontWeight="Bold"/>
                          </Grid>
                        </Border>
                      </StackPanel>

                      <!-- AnalogInput1 -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Analog Input 1</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Voltage reading from analog input 1</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="3" Padding="10" Margin="10,0,0,0">
                          <Grid ColumnDefinitions="Auto,*">
                            <TextBlock Grid.Column="0" Text="Voltage:" VerticalAlignment="Center"
                                       FontWeight="SemiBold" Margin="0,0,15,0"/>
                            <TextBlock Grid.Column="1"
                                       Text="{Binding AnalogData,
                         Converter={StaticResource PayloadFieldConverter},
                         ConverterParameter='AnalogInput1'}"
                                       VerticalAlignment="Center" FontSize="14" FontWeight="Bold"/>
                          </Grid>
                        </Border>
                      </StackPanel>
                    </StackPanel>
                  </Border>


                </StackPanel>

                <!-- Camera Controls -->
                <StackPanel Grid.Row="1" Grid.Column="1" Spacing="20" Margin="0,0,40,0" MinWidth="300">

                  <!-- Camera 0 Configuration -->
                  <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                    <StackPanel Spacing="15">
                      <TextBlock Text="Camera 0" FontWeight="Bold" FontSize="14"/>

                      <!-- Camera 0 Control -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <Label FontWeight="SemiBold" FontSize="12" Padding="0">Camera Control</Label>
                        <StackPanel Orientation="Horizontal" Spacing="10" Margin="10,0,0,0">
                          <!--<CheckBox IsChecked="{Binding IsCameraOutput0Enabled_StartCameras}" IsEnabled="True">
                            Start
                          </CheckBox>
                          <CheckBox IsChecked="{Binding IsCameraOutput0Enabled_StopCameras}" IsEnabled="True">
                            Stop
                          </CheckBox>-->
                          <ToggleButton IsChecked="{Binding IsCameraOutput0Enabled_StartCameras}"
                                          Command="{Binding Camera0StartCommand}">
                            Start
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsCameraOutput0Enabled_StopCameras}"
                                        Command="{Binding Camera0StopCommand}">
                            Stop
                          </ToggleButton>
                        </StackPanel>
                      </StackPanel>

                      <!-- Camera 0 Frame Status -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Frame Status</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Indicates when a frame was acquired on camera 0</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="10,0,0,0">
                          <controls:VisualStatus Status="{Binding IsFrameAcquiredEnabled_Camera0Frame}"
                                                Width="15" Height="15" />
                          <TextBlock Text="Frame Acquired" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>

                      <!-- Camera 0 Frequency -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Trigger Frequency</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Specifies the trigger frequency for camera 0 (1-600 Hz)</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <NumericUpDown Value="{Binding Camera0Frequency}"
                                     Minimum="1" Maximum="600" ClipValueToMinMax="True"
                                     Increment="1" FormatString="F0" Width="200"
                                     HorizontalAlignment="Left" Margin="10,0,0,0" />
                      </StackPanel>

                      <!-- Camera 0 Apply Button -->
                      <Button Content="Apply"
                              Command="{Binding CameraApplyConfigurationCommand}"
                              Margin="0,10,0,0"
                              HorizontalAlignment="Right"
                              VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                    </StackPanel>
                  </Border>

                  <!-- Camera 1 Configuration -->
                  <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                    <StackPanel Spacing="15">
                      <TextBlock Text="Camera 1" FontWeight="Bold" FontSize="14"/>

                      <!-- Camera 1 Control -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <Label FontWeight="SemiBold" FontSize="12" Padding="0">Camera Control</Label>
                        <StackPanel Orientation="Horizontal" Spacing="10" Margin="10,0,0,0">
                          <!--<CheckBox IsChecked="{Binding IsCameraOutput1Enabled_StartCameras}" IsEnabled="True">
                            Start
                          </CheckBox>
                          <CheckBox IsChecked="{Binding IsCameraOutput1Enabled_StopCameras}" IsEnabled="True">
                            Stop
                          </CheckBox>-->
                          <ToggleButton IsChecked="{Binding IsCameraOutput1Enabled_StartCameras}"
                                          Command="{Binding Camera1StartCommand}">
                            Start
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsCameraOutput1Enabled_StopCameras}"
                                        Command="{Binding Camera1StopCommand}">
                            Stop
                          </ToggleButton>

                        </StackPanel>
                      </StackPanel>

                      <!-- Camera 1 Frame Status -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Frame Status</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Indicates when a frame was acquired on camera 1</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="5" Margin="10,0,0,0">
                          <controls:VisualStatus Status="{Binding IsFrameAcquiredEnabled_Camera1Frame}"
                                                Width="15" Height="15" />
                          <TextBlock Text="Frame Acquired" VerticalAlignment="Center"/>
                        </StackPanel>
                      </StackPanel>

                      <!-- Camera 1 Frequency -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Trigger Frequency</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Specifies the trigger frequency for camera 1 (1-600 Hz)</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <NumericUpDown Value="{Binding Camera1Frequency}"
                                     Minimum="1" Maximum="600" ClipValueToMinMax="True"
                                     Increment="1" FormatString="F0" Width="200"
                                     HorizontalAlignment="Left" Margin="10,0,0,0" />
                      </StackPanel>

                      <!-- Camera 1 Apply Button -->
                      <Button Content="Apply"
                              Command="{Binding CameraApplyConfigurationCommand}"
                              Margin="0,10,0,0"
                              HorizontalAlignment="Right"
                              VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                    </StackPanel>
                  </Border>
                </StackPanel>

                <!-- Servo Motor Controls -->
                <StackPanel Grid.Row="1" Grid.Column="2" Spacing="20" Margin="0,0,40,0" MinWidth="280">

                  <!-- Servo Motor 2 (DO2) Configuration -->
                  <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                    <StackPanel Spacing="15">
                      <TextBlock Text="Servo Motor 2 (DO2)" FontWeight="Bold" FontSize="14"/>

                      <!-- Servo Output 2 Control -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Servo Control</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Enable or disable servo motor output 2</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="10" Margin="10,0,0,0">
                          <!--<CheckBox IsChecked="{Binding IsServoOutput2Enabled_EnableServos}"
                     IsEnabled="True" Margin="0,0,15,0">Enable</CheckBox>
           <CheckBox IsChecked="{Binding IsServoOutput2Enabled_DisableServos}"
                     IsEnabled="True">Disable</CheckBox>-->
                          <ToggleButton IsChecked="{Binding IsServoOutput2Enabled_EnableServos}"
                                        Command="{Binding ServoOutput2StartCommand}">
                            Enable
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsServoOutput2Enabled_DisableServos}"
                                        Command="{Binding ServoOutput2StopCommand}">
                            Disable
                          </ToggleButton>
                        </StackPanel>
                      </StackPanel>

                      <!-- Period Control -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Period (μs)</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Period of the servo motor in DO2, in microseconds (2-65534)</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <NumericUpDown Value="{Binding ServoMotor2Period}"
                                     Minimum="2" Maximum="65534" ClipValueToMinMax="True"
                                     Increment="1" FormatString="F0" Width="200"
                                     HorizontalAlignment="Left" Margin="10,0,0,0" />
                      </StackPanel>

                      <!-- Pulse Control -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Pulse (μs)</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Pulse width of the servo motor in DO2, in microseconds (6-65530)</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <NumericUpDown Value="{Binding ServoMotor2Pulse}"
                                     Minimum="6" Maximum="65530" ClipValueToMinMax="True"
                                     Increment="1" FormatString="F0" Width="200"
                                     HorizontalAlignment="Left" Margin="10,0,0,0" />
                      </StackPanel>

                      <!-- Servo 2 Apply Button -->
                      <Button Content="Apply"
                              Command="{Binding ServoApplyConfigurationCommand}"
                              Margin="0,10,0,0"
                              HorizontalAlignment="Right"
                              VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>0</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                    </StackPanel>
                  </Border>

                  <!-- Servo Motor 3 (DO3) Configuration -->
                  <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                    <StackPanel Spacing="15">
                      <TextBlock Text="Servo Motor 3 (DO3)" FontWeight="Bold" FontSize="14" />

                      <!-- Servo Output 3 Control -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Servo Control</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Enable or disable servo motor output 3</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="10" Margin="10,0,0,0">
                          <!--<CheckBox IsChecked="{Binding IsServoOutput3Enabled_EnableServos}"
                     IsEnabled="True" Margin="0,0,15,0">Enable</CheckBox>
           <CheckBox IsChecked="{Binding IsServoOutput3Enabled_DisableServos}"
                     IsEnabled="True">Disable</CheckBox>-->
                          <ToggleButton IsChecked="{Binding IsServoOutput3Enabled_EnableServos}"
                                        Command="{Binding ServoOutput3StartCommand}">
                            Enable
                          </ToggleButton>
                          <ToggleButton IsChecked="{Binding IsServoOutput3Enabled_DisableServos}"
                                        Command="{Binding ServoOutput3StopCommand}">
                            Disable
                          </ToggleButton>
                        </StackPanel>
                      </StackPanel>

                      <!-- Period Control -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Period (μs)</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Period of the servo motor in DO3, in microseconds (2-65534)</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <NumericUpDown Value="{Binding ServoMotor3Period}"
                                     Minimum="2" Maximum="65534" ClipValueToMinMax="True"
                                     Increment="1" FormatString="F0" Width="200"
                                     HorizontalAlignment="Left" Margin="10,0,0,0" />
                      </StackPanel>

                      <!-- Pulse Control -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Pulse (μs)</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Pulse width of the servo motor in DO3, in microseconds (6-65530)</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <NumericUpDown Value="{Binding ServoMotor3Pulse}"
                                     Minimum="6" Maximum="65530" ClipValueToMinMax="True"
                                     Increment="1" FormatString="F0" Width="200"
                                     HorizontalAlignment="Left" Margin="10,0,0,0" />
                      </StackPanel>

                      <!-- Servo 2 Apply Button -->
                      <Button Content="Apply"
                              Command="{Binding ServoApplyConfigurationCommand}"
                              Margin="0,10,0,0"
                              HorizontalAlignment="Right"
                              VerticalAlignment="Center">
                        <Button.CommandParameter>
                          <x:Int32>1</x:Int32>
                        </Button.CommandParameter>
                      </Button>
                    </StackPanel>
                  </Border>
                </StackPanel>

                <!-- Quadrature Encoder Controls -->
                <StackPanel Grid.Row="1" Grid.Column="3" Spacing="20" Margin="0,0,40,0" MinWidth="280">

                  <!-- Encoder Data Display -->
                  <StackPanel Orientation="Vertical" Spacing="10">
                    <StackPanel Orientation="Horizontal" Spacing="5">
                      <Label FontWeight="Bold" FontSize="16" Padding="0">Encoder Data</Label>
                      <heroIcons:HeroIcon Type="InformationCircle" Width="14" Height="14"
                                          Foreground="{Binding IconColor}" VerticalAlignment="Top">
                        <ToolTip.Tip>Current encoder value on Port 2</ToolTip.Tip>
                      </heroIcons:HeroIcon>
                    </StackPanel>
                    <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                      <Grid ColumnDefinitions="Auto,*">
                        <TextBlock Grid.Column="0" Text="Encoder Value:" VerticalAlignment="Center"
                                   FontWeight="SemiBold" Margin="0,0,15,0"/>
                        <TextBlock Grid.Column="1"
                                   Text="{Binding AnalogData, Converter={StaticResource PayloadFieldConverter}, ConverterParameter='Encoder'}"
                                   VerticalAlignment="Center" FontSize="16" FontWeight="Bold"/>
                      </Grid>
                    </Border>
                  </StackPanel>

                  <!-- Encoder Configuration -->
                  <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                    <StackPanel Spacing="15">
                      <TextBlock Text="Port 2 Encoder Configuration" FontWeight="Bold" FontSize="14"/>

                      <!-- Enable Encoder -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Enable Encoder</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Enable the quadrature counter on Port 2</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <CheckBox IsChecked="{Binding IsEncoderPort2Enabled_EnableEncoders}"
                                  IsEnabled="True" Margin="10,0,0,0">
                          Enable Port 2 Encoder
                        </CheckBox>
                      </StackPanel>

                      <!-- Encoder Mode -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Operation Mode</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Configure the operation mode of the quadrature encoder</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <ComboBox SelectedItem="{Binding EncoderMode, Mode=TwoWay}"
                                  IsEnabled="True" Width="200"
                                  HorizontalAlignment="Left" Margin="10,0,0,0">
                          <x:Static Member="local:EncoderModeConfig.Position" />
                          <x:Static Member="local:EncoderModeConfig.Displacement" />
                        </ComboBox>
                      </StackPanel>

                      <!-- Reset Encoder -->
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Reset Counter</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Reset the encoder counter to zero</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <CheckBox IsChecked="{Binding IsEncoderPort2Enabled_EncoderReset}"
                                  IsEnabled="True" Margin="10,0,0,0">
                          Reset Port 2 Encoder
                        </CheckBox>
                      </StackPanel>

                      <!-- Servo 2 Apply Button -->
                      <Button Content="Apply"
                              Command="{Binding EncoderApplyConfigurationCommand}"
                              Margin="0,10,0,0"
                              HorizontalAlignment="Right"
                              VerticalAlignment="Center">
                      </Button>
                    </StackPanel>
                  </Border>
                </StackPanel>

                <StackPanel Grid.Row="1" Grid.Column="4" Spacing="20" Margin="0,0,40,0" MinWidth="280">

                  <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Padding="15">
                    <StackPanel Spacing="15">
                      <TextBlock Text="Input Value" FontWeight="Bold" FontSize="14"/>
 
                      
                      <StackPanel Orientation="Vertical" Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                          <Label FontWeight="SemiBold" FontSize="12" Padding="0">Register Value</Label>
                          <heroIcons:HeroIcon Type="InformationCircle" Width="12" Height="12"
                                              Foreground="{Binding IconColor}" VerticalAlignment="Top">
                            <ToolTip.Tip>Direct numeric value for EnableSerialTimestamp register (0-255)</ToolTip.Tip>
                          </heroIcons:HeroIcon>
                        </StackPanel>
                        <NumericUpDown Value="{Binding EnableSerialTimestamp}"
                                       Minimum="0"
                                       Maximum="255"
                                       ClipValueToMinMax="True"
                                       Increment="1"
                                       FormatString="F0"
                                       Width="200"
                                       HorizontalAlignment="Left"
                                       Margin="10,0,0,0" />
                      </StackPanel>

                      <Button Content="Apply"
                              Command="{Binding SerialTimestampApplyConfigurationCommand}"
                              Margin="0,10,0,0"
                              HorizontalAlignment="Right"
                              VerticalAlignment="Center">
                      </Button>
                    </StackPanel>
                  </Border>
                 </StackPanel>
              </Grid>
            </TabItem>

          </TabControl>
        </StackPanel>
      </StackPanel>
    </ScrollViewer>
  </DockPanel>
</UserControl>
